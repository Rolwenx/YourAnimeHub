<%
const title = 'Recently Added Manga - YourAnimeHub';
%>
<%- include('../partials/header.ejs', { title: title }) %>

<link type="text/css" rel="stylesheet" href="/css/styleBrowseAnime.css">

<div class="background"></div>

<div class="background_accent"></div>

<section>
  <div class="recently_added_block">
      <div class="cardHeader">
          <h2>Recently Added Manga</h2>
      </div>
    <div class="recentAnime">
      <div class="animeCard">
        <% if (mangaList && Array.isArray(mangaList) && mangaList.length > 0) { %>
          <% const recentMangaList = mangaList.slice(-4).reverse(); %> 
          <% recentMangaList.forEach(manga => { %>
            <div class="card">
              <a href="/manga/<%= manga.id %>">
                <img class="cover_image" src="<%= manga.CoverImageURL %>" alt="<%= manga.TitleEnglish %>">
              </a>
              <div class="animeName">
                <a href="/manga/<%= manga.id %>"><%= manga.TitleEnglish %></a>
              </div>
            </div>
          <% }); %>
        <% } else { %>
          <p>No manga available in the database.</p>
        <% } %>
      </div>

    </div>
    <div class="load-more-container">
      <button id="load-more-button" class="load-more-button">Load More</button>
    </div>
</div>
</section>
<script>
  document.addEventListener("DOMContentLoaded", function () {
      let displayedAnimeCount = 4;

      const animeCards = document.querySelectorAll(".animeCard .card");

      // Initially hide cards greater than 6
      animeCards.forEach((card, index) => {
          if (index >= displayedAnimeCount) {
              card.style.display = "none";
          }
      });

      document.getElementById("load-more-button").addEventListener("click", function () {
          for (let i = displayedAnimeCount; i < displayedAnimeCount + 4; i++) {
              if (i < animeCards.length) {
                  animeCards[i].style.display = "inline";
              }
          }

          displayedAnimeCount += 4;

          // Hide load more button if all anime are displayed
          if (displayedAnimeCount >= animeCards.length) {
              document.getElementById("load-more-button").style.display = "none";
          }
      });
  });
</script>
<%- include('../partials/footer.ejs', { title: title }) %>

</body>
</html>